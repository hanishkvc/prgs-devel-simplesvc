do_diff interactive prompt logic cleaned up

